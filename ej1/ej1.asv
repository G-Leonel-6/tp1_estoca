%ejercicio 1
% a) segmentacion del audio


[data, fs] = audioread('../Archivos/audio_01_2024a.wav');
sign_norm = data / (rms(data));
L = 2;
columnas = ceil(length(sign_norm) / L);

x_m = zeros(L, columnas);

<<<<<<< HEAD
j = 1;
i = 1;
iter = 1;
while j <= columnas + 1
    while i <= 2 && iter < length(sign_norm) + 1
        x_m(i, j) = sign_norm(iter)/columnas;
        iter = iter + 1;
        i = i + 1;
    end
    i = 1;
    j = j + 1;
end

% b) grafico de dispersion de x_m
figure();
tiledlayout(3,3);

nexttile([1 , 2])
hold on
grid on
xlabel('x_0');
ylabel('f_{x_0}(x_0)');
title('Histograma de X_0');
histogram(x_m(1, :), 50, 'Normalization', 'probability');
hold off

nexttile([2 2])
hold on
grid on
xlabel('x_0');
ylabel('x_1');
title('Dispersión de X_0 y X_1 ')
scatter(x_m(1, :), x_m(2, :))
hold off

nexttile(6,[2 1])
hold on
grid on
xlabel('x_1');
xlabel('f_{x_1}(x_1)');
title('Histograma de X_1')
histogram(x_m(2, :), 50, 'Normalization', 'probability', 'orientation', 'horizontal');
hold off
=======
for i=1:columnas
    for j = 1:columnas
        if((i-1)*columnas+j > length(sign_norm))
            break;
        end
        
        x_m(i, j) = sign_norm((i-1)*columnas+j);
    end
end

x_m(end, end-1)
sign_norm(end)

% b) grafico de dispersion de x_m
figure();
tiledlayout(1,3);

nexttile
histogram(x_m(1, :), 50);

nexttile
scatter(x_m(1, :), x_m(2, :))

nexttile
histogram(x_m(2, :), 50);

>>>>>>> f1d9b0b19080a52ed2b8323b3fc065b4b9051e12
% c) matriz de covarianza 

%calculo la esperanza de x_m
mu_x = mean(transpose(x_m));

<<<<<<< HEAD
cx = cov(x_m');
=======
cx = cov(x_m')
>>>>>>> f1d9b0b19080a52ed2b8323b3fc065b4b9051e12

%autovalores y autovectores

[avec, avas] = eig(cx);

%defino la matriz Y = U^T * X

y_m = avec' * x_m;


% b) grafico de dispersion de y_m
figure();
<<<<<<< HEAD
tiledlayout(3,3);

nexttile([1, 2])
hold on
xlabel('y_0');
ylabel('f_{y_0}(y_0)');
title('Histograma de Y_0')
grid on
histogram(y_m(1, :), 50,  'Normalization', 'probability');
hold off

nexttile([2,2])
hold on
grid on
xlabel('y_0');
ylabel('y_1');
title('Dispersión de Y_0 e Y_1');
scatter(y_m(1, :), y_m(2, :))
hold off

nexttile(6, [2,1])
hold on
grid on
xlabel('y_1');
ylabel('f_{y_1}(y_1)');
title('Histograma de Y_1')
histogram(y_m(2, :), 50, 'Normalization', 'probability', 'orientation', 'horizontal');
=======
tiledlayout(1,3);

nexttile
histogram(y_m(1, :), 50);

nexttile
scatter(y_m(1, :), x_m(2, :))

nexttile
histogram(y_m(2, :), 50);
>>>>>>> f1d9b0b19080a52ed2b8323b3fc065b4b9051e12
